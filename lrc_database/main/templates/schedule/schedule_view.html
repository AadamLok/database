{% extends "base.html" %}

{% load schedule %}

{% block extra_includes %}
	<script type="text/javascript" defer> 
		window.onload = function() { 
			document.getElementById("course-check").addEventListener('change', function () {
				document.getElementById("check").submit();
			});
		}
	</script>  
{% endblock%}

{% block content %}

<h2>{{kind}} Schedule</h2>

<div class="table-responsive">
	{% if privileged %}
		<div class="container-fluid">
			<div class="row">
				<div class="col-2">
					<div class="left-table-button padding-5px-tb padding-15px-lr margin-10px-bottom">
						{% with new_offset=offset|add:'-7' %}
							<a href="{% url 'view_schedule' kind new_offset %}" class="table-button bg-dark"><<</a>
						{% endwith %}
						{% with new_offset=offset|add:'-1' %}
							<a href="{% url 'view_schedule' kind new_offset %}" class="table-button bg-dark"><</a>
						{% endwith %}
					</div>
				</div>
				<div class="center-table-button col-8">
					<form id="check" method="post" action="{% url 'view_schedule' kind offset %}">
						{% csrf_token %}
						<input name="few" class="form-check-input" type="checkbox" id="course-check" {% if checked %} checked {% endif %}>
						<label class="form-check-label" for="course-check">
							Only show course with shifts
						</label>
					</form>
				</div>
				<div class="col-2">
					<div class="right-table-button padding-5px-tb padding-15px-lr margin-10px-bottom">
						{% with new_offset=offset|add:'1' %}
							<a href="{% url 'view_schedule' kind new_offset %}" class="table-button bg-dark">></a>
						{% endwith %}
						{% with new_offset=offset|add:'7' %}
							<a href="{% url 'view_schedule' kind new_offset %}" class="table-button bg-dark">>></a>
						{% endwith %}
					</div>
				</div>
			</div>
		</div>
	{% endif %}
	<table class="table table-bordered text-center equal-col">
		<thead>
			<tr>
				<th scope="col" class="text-uppercase align-middle">Course</th>
				{% for day in weekdays %}
					<th scope="col" class="text-uppercase align-middle"><span>{{ day|date:"l" }}<span><div>{{ day|date:"m/d" }}</div></th>
				{% endfor %}
			</tr>
		</thead>
		<tbody>
			{% for course, days in info.items %}
				<tr>
					<td class="align-middle">{% if privileged %}<a href="{% url 'view_course' days.0 %}">{{course}}</a>{% else %}{{course}}{% endif %}</td>
					{% for day in days.1 %}
						{% if day|length == 0 %}
							<td class="bg-light-gray"></td>
						{% else %}
							<td>
								{% for s in day %}
									<div class="margin-10px-top" {% if s.exam_rev %}style="background-color: rgb(250,250,210);"{% endif %}>
										{% if s.kind == "SI" %}
											<div class="font-size16 text-break text-wrap" style="margin-bottom:10px">{% if s.shift.position.si_course.faculty.0 == "*" %}All Sections{% else %}{{s.shift.position.si_course.faculty}}{% endif %}</div>
										{% endif %}
										<div class="{% if s.shift.kind == 'SI' or s.shift.kind == 'Group Tutoring' %}bg-lightred{% elif s.shift.kind == 'Tutor Drop In' %}bg-green{% elif s.shift.kind == 'Tutor Appointment'%}bg-sky{% endif %} padding-5px-tb 
											padding-15px-lr border-radius-5 margin-10px-bottom text-white font-size16 
											xs-font-size13">{{s.shift.location}}</div>
										<div class="margin-10px-top font-size14">{{s.shift.start| date:"h:i A" |lower}} - {{s.shift.start|add_datetime:s.shift.duration|date:"h:i A"|lower}}</div>
										<div class="font-size13 text-break text-wrap">{% if privileged %}<a href="{% url 'user_profile' s.shift.position.person.id %}">{% endif %}{{s.shift.position.person}}{% if privileged %}</a>{% endif %}</div>
									</div>
									{% if not forloop.last %}
										<div class="mb-1 mt-1" style="height:2px;background-color:rgba(0,0,0,0.2);border-radius:1px;"></div>
									{% endif %}
								{% endfor %}
							</td>
						{% endif %}
					{% endfor %}
				</tr>
			{% endfor %}
		</tbody>
	</table>
</div>

{% endblock %}